# ========================================
# Database Configuration
# ========================================
# PostgreSQL configuration
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=whisper_summarizer

# Supabase Configuration
SUPABASE_URL=your-supabase-url
SUPABASE_ANON_KEY=your-supabase-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key

# Supabase PostgreSQL接続文字列
# SupabaseダッシュボードのSettings > Database > Connection Stringから取得
# 形式: postgresql://postgres:[YOUR-PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres
DATABASE_URL=postgresql://postgres:[YOUR-PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres

# ========================================
# Nginx Configuration ⭐ NEW
# ========================================
# Nginx reverse proxy configuration
# NGINX_HOST: Server hostname (localhost, whisper.local, your-domain.com)
NGINX_HOST=localhost
# NGINX_PORT: HTTP port exposed to Cloudflare Tunnel (default: 8130)
NGINX_PORT=8130

# ========================================
# Server/Runner Configuration
# ========================================
# API key for runner authentication (MUST match between server and runner)
RUNNER_API_KEY=your-super-secret-runner-api-key-change-this

# ========================================
# GLM API設定 (OpenAI-compatible) - MOVED TO RUNNER
# ========================================
# GLM API Key from https://z.ai/ (international platform)
GLM_API_KEY=your_glm_api_key_here
# GLM Model: GLM-4.5-Air (recommended), GLM-4.5, GLM-4-Flash, etc.
GLM_MODEL=GLM-4.5-Air
# GLM API Base URL (international endpoint)
GLM_BASE_URL=https://api.z.ai/api/paas/v4/
# Review Language: zh (Chinese), ja (Japanese), en (English)
REVIEW_LANGUAGE=zh

# ========================================
# Server Configuration
# ========================================
# SERVER_PORT: Internal port only (nginx routes /api to this)
SERVER_PORT=8000
# CORS_ORIGINS: Updated for nginx (use nginx host, not port 3000)
CORS_ORIGINS=http://localhost
# TRUSTED_HOSTS: Allowed hosts for forwarded headers
TRUSTED_HOSTS=localhost,nginx
LOG_LEVEL=INFO

# Pagination
DEFAULT_PAGE_SIZE=10
MAX_PAGE_SIZE=100

# ========================================
# Frontend Configuration
# ========================================
# Use relative path - nginx handles routing to /api
VITE_SUPABASE_URL=${SUPABASE_URL}
VITE_SUPABASE_ANON_KEY=${SUPABASE_ANON_KEY}
VITE_BACKEND_URL=/api

# ========================================
# Runner Configuration ⭐ UPDATED
# ========================================
# RUNNER_SERVER_URL: Server URL for runner polling
# - Development: http://server:8000 (internal Docker network)
# - Production: http://nginx or https://your-domain.com
RUNNER_SERVER_URL=http://server:8000

# ========================================
# faster-whisper Configuration (RUNNER ONLY)
# ========================================
# Device: cuda (GPU) or cpu
FASTER_WHISPER_DEVICE=cuda
# Compute type: int8_float16 (GPU, mixed precision - recommended), float16 (GPU, fastest), int8 (CPU)
FASTER_WHISPER_COMPUTE_TYPE=int8_float16
# Model size: large-v3-turbo (recommended), large-v3, medium, small
FASTER_WHISPER_MODEL_SIZE=large-v3-turbo
# Language: auto (detect), zh (Chinese), ja (Japanese), en (English)
WHISPER_LANGUAGE=zh
# Number of worker threads
WHISPER_THREADS=4

# ========================================
# Audio Chunking (RUNNER ONLY)
# ========================================
ENABLE_CHUNKING=true
CHUNK_SIZE_MINUTES=10
CHUNK_OVERLAP_SECONDS=15
MAX_CONCURRENT_CHUNKS=4
USE_VAD_SPLIT=true
VAD_SILENCE_THRESHOLD=-30
VAD_MIN_SILENCE_DURATION=0.5
MERGE_STRATEGY=lcs

# ========================================
# Runner Polling Configuration
# ========================================
POLL_INTERVAL_SECONDS=10
MAX_CONCURRENT_JOBS=2
JOB_TIMEOUT_SECONDS=3600

# ========================================
# Data Retention (Auto-Delete)
# ========================================
MAX_KEEP_DAYS=7
CLEANUP_HOUR=9

# ========================================
# Testing
# ========================================
DISABLE_AUTH=false
